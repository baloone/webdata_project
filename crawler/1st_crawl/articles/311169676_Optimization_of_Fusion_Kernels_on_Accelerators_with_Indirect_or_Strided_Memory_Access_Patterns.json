{"id":"311169676_Optimization_of_Fusion_Kernels_on_Accelerators_with_Indirect_or_Strided_Memory_Access_Patterns","abstract":"This paper describes optimization for high-dimensional stencil computations on accelerators involving complex memory access patterns, which appear in five dimensional fusion plasma turbulence codes, GYSELA and GT5D. They include different types of memory access patterns, the indirect memory access in GYSELA with a Semi-Lagrangian scheme and the strided memory access in GT5D with a Finite-Difference scheme. We focus on the affinity of the memory access patterns to accelerators such as GPGPUs and Xeon Phi coprocessors. On both devices, the Array of Structure of Array (AoSoA) data layout is preferable for contiguous memory accesses. It is shown that the effective local cache usage by improving spatial and temporal data locality is critical on Xeon Phi. On GPGPU, the texture memory usage improves the performance of the indirect memory accesses in the Semi-Lagrangian scheme. The reuse of registers by taking account of the physical symmetry of the Finite-Difference scheme reduces the amount of memory accesses. Through these optimizations, we achieve acceleration of 3.9 (8.1) on Xeon Phi (GPGPU) for the Semi-Lagrangian scheme and of 1.4 (3.9) on Xeon Phi (GPGPU) for the Finite-Different scheme with respect to the fully optimized codes on Sandy Bridge.","authors":["Yuuichi Asahi","Guillaume Latu","Takuya Ina","Yasuhiro Idomura"],"meta":["November 2016IEEE Transactions on Parallel and Distributed Systems PP(99):1-1","DOI:10.1109/TPDS.2016.2633349"],"references":["275168054_Scaling_GYSELA_code_beyond_32K-cores_on_Blue_GeneQ","273704326_Evaluating_Kernels_on_Xeon_Phi_to_accelerate_Gysela_application","271481064_Enabling_and_Scaling_a_Global_Shallow-Water_Atmospheric_Model_on_Tianhe-2","268788100_Comparative_Performance_Analysis_of_Intel_Xeon_Phi_GPU_and_CPU_A_Case_Study_from_Microscopy_Image_Analysis","266856549_Multicore-Optimized_Wavefront_Diamond_Blocking_for_Optimizing_Stencil_Updates","266755045_Foundations_of_nonlinear_gyrokinetic_theory","258082578_An_Empirical_Study_of_Intel_Xeon_Phi","243418103_TOPICAL_REVIEW_Gyrokinetic_simulations_of_turbulent_transport","234816739_Stencil_computation_optimization_and_auto-tuning_on_state-of-the-art_multicore_architectures","220949231_On_the_Energy_Efficiency_of_Graphics_Processing_Units_for_Scientific_Computing","220423225_Roofline_An_Insightful_Visual_Performance_Model_for_Multicore_Architectures","220184104_A_semi-Lagrangian_contouring_method_for_fluid_simulation","308189780_A_mixed_precision_semi-Lagrangian_algorithm_and_its_performance_on_accelerators","300094450_OpenCL_There_and_Back_Again","300094264_Exploiting_Multilevel_Parallelism_in_Quantum_Simulations","300093387_Cosmic_Microwave_Background_Analysis","290027946_Nuclear_Fusion_Simulation_Code_Optimization_and_Performance_Evaluation_on_GPU_Cluster","285433577_Plesiochronous_Phasing_Barriers","278619511_A_5D_gyrokinetic_full-_global_semi-Lagrangian_code_for_flux-driven_ion_turbulence_simulations","273462984_Accelerating_the_Pace_of_Protein_Functional_Annotation_With_Intel_Xeon_Phi_Coprocessors","256919027_Optimizing_2D_and_3D_structured_Euler_CFD_solvers_on_Graphical_Processing_Units","254073073_Communication-Avoiding_Krylov_Subspace_Methods","241770335_High-performance_code_generation_for_stencil_computations_on_GPU_architectures","223712158_Conservative_global_gyrokinetic_toroidal_full-f_five-dimensional_Vlasov_simulation","222668852_Computing_ITG_turbulence_with_a_full-f_semi-Lagrangian_code","222490671_Fully_Conservative_Higher_Order_Finite_Difference_Schemes_for_Incompressible_Flow","222450527_The_integration_of_the_Vlasov_equation_in_configuration_space","202924427_On_the_Construction_and_Comparison_of_Difference_Schemes","45924720_Simulating_spin_models_on_GPU","5951054_Accelerating_molecular_modeling_applications_with_graphics_processors_Journal_of_Computational_Chemistry_2816_2618-2640","2615110_A_Comparison_of_Compiler_Tiling_Algorithms"]}